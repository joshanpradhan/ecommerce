{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <title>Shoppers &mdash; Colorlib e-Commerce Template</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    {% include 'base/css.html' %}
</head>

<body>
    {% include 'base/navbar.html' %}
    {% block content %} {% endblock %}
    {% include 'base/footer.html' %}
    {% include 'base/js.html' %}
    <script type="text/javascript">
    $(document).ready(function() {
        var productForm = $(".form-product-ajax");
        productForm.submit(function(event) {

            event.preventDefault();
            console.log("Form is not sending");
            var thisForm = $(this)
            // var actionEndpoint = thisForm.attr("action");
            var actionEndpoint = thisForm.attr("data-endpoint");
            var httpmethod = thisForm.attr("method");
            var formData = thisForm.serialize();

            $.ajax({
                url: actionEndpoint,
                method: httpmethod,
                data: formData,
                success: function(data) {
                    var submitSpan = thisForm.find(".submit-span");
                    if (data.added) {
                        submitSpan.html("<button type='submit' class='buy-now btn btn-sm btn-danger'>Remove From Cart</button>");
                    } else {
                        submitSpan.html("<button type='submit' class='buy-now btn btn-sm btn-primary'>Add To Cart</button>");
                    }

                    var navbarCount = $(".navbar-cart-count");
                    navbarCount.text(data.cartItemCount);
                    if (window.location.href.indexOf("cart") != -1) {
                        updateCart();
                    }
                },
                error: function(errorData) {

                    console.log("error");
                    console.log(errorData);
                }

            })

        })

        function updateCart() {

        }

    })
    </script>
</body>

</html>